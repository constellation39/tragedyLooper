syntax = "proto3";

package v1;

import "google/protobuf/any.proto";
import "google/protobuf/timestamp.proto";
import "v1/card.proto";
import "v1/enums.proto";

option go_package = "tragedylooper/internal/game/v1;v1";

// GameEvent 表示游戏中发生的事件。
message GameEvent {
  GameEventType type = 1;
  google.protobuf.Any payload = 2;
  google.protobuf.Timestamp timestamp = 3;
}

message GameEventLib {
  map<int32, google.protobuf.Any> events = 1;
}

message CharacterMovedEvent {
  int32 character_id = 1;
  LocationType new_location = 2;
}

message ParanoiaAdjustedEvent {
  int32 character_id = 1;
  int32 amount = 2;
  int32 new_paranoia = 3;
}

message GoodwillAdjustedEvent {
  int32 character_id = 1;
  int32 amount = 2;
  int32 new_goodwill = 3;
}

message IntrigueAdjustedEvent {
  int32 character_id = 1;
  int32 amount = 2;
  int32 new_intrigue = 3;
}

message LoopLossEvent {
  IncidentType incident_type = 1;
}

message LoopWinEvent {}

message AbilityUsedEvent {
  int32 character_id = 1;
  string ability_name = 2;
}

message DayAdvancedEvent {
  int32 day = 1;
  int32 loop = 2;
}

message CardPlayedEvent {
  map<int32, CardList> played_cards = 1;
}

message LoopResetEvent {
  int32 loop = 1;
}

message GameOverEvent {
  PlayerRole winner = 1;
}

// Choice 表示玩家可以做出的选择。
message Choice {
  string description = 1;
  int32 character_id = 2;
}
message ChoiceRequiredEvent {
  // 这可能需要更复杂的结构，具体取决于选择
  repeated Choice choices = 1;
}

message Incident {
  string name = 1;
  int32 day = 2;
  string culprit = 3;
  string victim = 4;
  string description = 5;
}

message IncidentTriggeredEvent {
  Incident incident = 1;
}
