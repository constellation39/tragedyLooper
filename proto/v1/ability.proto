syntax = "proto3";

package v1;

import "v1/effect.proto";
import "v1/enums.proto";

option go_package = "tragedylooper/internal/game/v1;v1";

// AbilityConfig represents the static configuration of an ability.
message AbilityConfig {
  int32 id = 1; // Unique ID for the ability configuration
  string name = 2; // Name of the ability
  string description = 3; // Description of the ability
  TriggerType trigger_type = 4; // When the ability triggers
  repeated GameEventType event_filters = 5; // Optional: Filters for ON_GAME_EVENT trigger type
  Effect effect = 6; // The effect of the ability
  bool once_per_loop = 7; // Whether the ability can be used only once per loop
  PlayerRole refusal_role = 8; // The player role that can refuse this ability
  bool is_passive = 10; // Whether this is a passive ability
  bool is_mandatory = 11; // Whether this ability is mandatory
}

// Ability represents a runtime instance of an ability.
message Ability {
  int32 id = 1; // The ID of the ability, linking to an AbilityConfig
  bool used_this_loop = 2; // Runtime state: whether this ability has been used in the current loop
}

// AbilityConfigLib holds a library of ability configurations.
message AbilityConfigLib {
  map<int32, AbilityConfig> abilities = 1;
}
