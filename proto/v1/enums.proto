syntax = "proto3";

package proto.v1;

option go_package = "github.com/user/repo/proto/model";

// CardType 定义玩家可以打出的卡牌类型。
enum CardType {
  CARD_TYPE_UNSPECIFIED = 0;
  CARD_TYPE_MOVEMENT = 1; // 移动
  CARD_TYPE_PARANOIA = 2; // 妄想
  CARD_TYPE_GOODWILL = 3; // 好感
  CARD_TYPE_INTRIGUE = 4; // 阴谋
  CARD_TYPE_SPECIAL = 5; // 用于特殊卡牌效果
}

// PlayerRole 定义连接玩家的角色（人类或 LLM）。
enum PlayerRole {
  PLAYER_ROLE_UNSPECIFIED = 0;
  PLAYER_ROLE_MASTERMIND = 1; // 主谋
  PLAYER_ROLE_PROTAGONIST = 2; // 主角
}

// GamePhase 定义游戏日期的当前阶段。
enum GamePhase {
  GAME_PHASE_UNSPECIFIED = 0;
  GAME_PHASE_MORNING = 1; // 早晨
  GAME_PHASE_CARD_PLAY = 2; // 出牌阶段
  GAME_PHASE_CARD_REVEAL = 3; // 牌揭示阶段
  GAME_PHASE_CARD_RESOLVE = 4; // 牌结算阶段
  GAME_PHASE_ABILITIES = 5; // 能力阶段
  GAME_PHASE_INCIDENTS = 6; // 事件阶段
  GAME_PHASE_DAY_END = 7; // 天结束
  GAME_PHASE_LOOP_END = 8; // 循环结束
  GAME_PHASE_GAME_OVER = 9; // 游戏结束
  GAME_PHASE_PROTAGONIST_GUESS = 10; // 最终猜测阶段
}

// GameEventType for GameEvent
enum GameEventType {
  GAME_EVENT_TYPE_UNSPECIFIED = 0;
  GAME_EVENT_TYPE_CARD_PLAYED = 1; // 打出卡牌
  GAME_EVENT_TYPE_CHARACTER_MOVED = 2; // 角色移动
  GAME_EVENT_TYPE_PARANOIA_ADJUSTED = 3; // 妄想调整
  GAME_EVENT_TYPE_GOODWILL_ADJUSTED = 4; // 好感调整
  GAME_EVENT_TYPE_INTRIGUE_ADJUSTED = 5; // 阴谋调整
  GAME_EVENT_TYPE_ABILITY_USED = 6; // 使用能力
  GAME_EVENT_TYPE_TRAGEDY_TRIGGERED = 7; // 悲剧触发
  GAME_EVENT_TYPE_TRAGEDY_PREVENTED = 8; // 悲剧阻止
  GAME_EVENT_TYPE_DAY_ADVANCED = 9; // 天数推进
  GAME_EVENT_TYPE_LOOP_RESET = 10; // 循环重置
  GAME_EVENT_TYPE_GAME_OVER = 11; // 游戏结束
  GAME_EVENT_TYPE_PLAYER_GUESS = 12; // 玩家猜测
  GAME_EVENT_TYPE_CHOICE_REQUIRED = 13; // 需要玩家选择
  GAME_EVENT_TYPE_INCIDENT_TRIGGERED = 14; // 事件触发
}

// ActionType 定义了玩家可以执行的操作类型。
enum ActionType {
  ACTION_TYPE_UNSPECIFIED = 0;
  ACTION_TYPE_PLAY_CARD = 1; // 出牌
  ACTION_TYPE_USE_ABILITY = 2; // 使用能力
  ACTION_TYPE_MAKE_GUESS = 3; // 作出猜测
  ACTION_TYPE_READY_FOR_NEXT_PHASE = 4; // 准备好进入下一阶段
}

// RoleType 定义了玩家在游戏中的具体角色。
enum RoleType {
  ROLE_TYPE_UNSPECIFIED = 0; // 未指定角色类型 (默认值)
  ROLE_TYPE_INNOCENT = 1; // 无辜者
  ROLE_TYPE_KILLER = 2; // 杀手
  ROLE_TYPE_BRAIN = 3; // 大脑
  ROLE_TYPE_KEY_PERSON = 4; // 关键人物
  ROLE_TYPE_FRIEND = 5; // 朋友
  ROLE_TYPE_CONSPIRACY_THEORIST = 6; // 阴谋论者
  ROLE_TYPE_CULTIST = 7; // 例如：具有善意拒绝的角色
  // 注意：Mastermind 和 Protagonist 也可以在 PlayerRole 中定义，这里是作为游戏内具体角色的一种。
  ROLE_TYPE_MASTERMIND = 8; // LLM 玩家角色 (主谋)
  ROLE_TYPE_PROTAGONIST = 9; // LLM 玩家角色 (主角)
}

// TragedyType 定义了剧本中可能发生的悲剧类型。
// TragedyType 定义了在游戏中可能发生的悲剧类型。
enum TragedyType {
  TRAGEDY_TYPE_UNSPECIFIED = 0; // 未指定悲剧类型 (默认值)
  TRAGEDY_TYPE_MURDER = 1; // 谋杀
  TRAGEDY_TYPE_SUICIDE = 2; // 自杀
  TRAGEDY_TYPE_SEALED = 3; // 例如：封印物品剧情
}

// TriggerType 定义了能力、规则或效果何时被激活或评估。
// 这个统一的枚举旨在澄清触发机制，明确区分基于游戏阶段的触发和基于事件的触发。
// 好的设计实践建议将触发条件与效果分离开来。
// 例如，一个能力可以有一个 `TriggerType` 来定义“何时”检查，以及一个效果列表来定义“做什么”。
enum TriggerType {
  TRIGGER_TYPE_UNSPECIFIED = 0;

  // --- 设置与循环触发器 ---
  TRIGGER_TYPE_ON_GAME_SETUP = 1; // 在游戏首次设置时触发。用于设置初始角色规则或状态。
  TRIGGER_TYPE_ON_LOOP_START = 2; // 在每个新循环开始时触发。

  // --- 阶段性触发器 (直接映射到 GamePhase) ---
  // 这些触发器在相应游戏阶段开始时激活。
  TRIGGER_TYPE_ON_DAY_START = 3;           // 对应 `GAME_PHASE_MORNING`。
  TRIGGER_TYPE_ON_CARD_PLAY_PHASE = 4;     // 对应 `GAME_PHASE_CARD_PLAY`。
  TRIGGER_TYPE_ON_CARD_REVEAL_PHASE = 5;   // 对应 `GAME_PHASE_CARD_REVEAL`。
  TRIGGER_TYPE_ON_CARD_RESOLVE_PHASE = 6;  // 对应 `GAME_PHASE_CARD_RESOLVE`。
  TRIGGER_TYPE_ON_ABILITY_PHASE = 7;       // 对应 `GAME_PHASE_ABILITIES`。
  TRIGGER_TYPE_ON_INCIDENT_PHASE = 8;      // 对应 `GAME_PHASE_INCIDENTS`。

  // --- 事件驱动触发器 (响应 GameEvent) ---
  // 使用这些触发器的能力/规则需要额外指定它们监听的 `GameEventType`。
  // 这种设计将“何时”触发（一般性事件）与“具体哪个事件”分离开来，增加了灵活性。
  TRIGGER_TYPE_ON_GAME_EVENT = 15; // 响应一个特定的游戏事件。

  // --- 持续性/被动触发器 ---
  TRIGGER_TYPE_PASSIVE = 20; // 表示一个持续生效的被动能力或规则。它的效果在任何时候都适用，而不是由单个事件触发。
}

// EffectType 定义能力或卡牌可能产生的效果类型。
// 这是组合方法的核心。
enum EffectType {
  EFFECT_TYPE_UNSPECIFIED = 0;
  EFFECT_TYPE_MOVE_CHARACTER = 1; // 移动角色
  EFFECT_TYPE_ADJUST_PARANOIA = 2; // 调整妄想
  EFFECT_TYPE_ADJUST_GOODWILL = 3; // 调整好感
  EFFECT_TYPE_ADJUST_INTRIGUE = 4; // 调整阴谋
  EFFECT_TYPE_REVEAL_ROLE = 5; // 用于特定能力，揭示角色
  EFFECT_TYPE_PREVENT_TRAGEDY = 6; // 阻止悲剧
  EFFECT_TYPE_GRANT_ABILITY = 7; // 授予能力
  EFFECT_TYPE_CHECK_LOCATION_ALONE = 8; // 用于悲剧条件，检查地点是否有人独处
  EFFECT_TYPE_CHECK_CHARACTER_STATUS = 9; // 用于悲剧条件，检查角色状态
}

// TargetRuleType 定义悲剧如何选择目标角色。
enum TargetRuleType {
  TARGET_RULE_TYPE_UNSPECIFIED = 0;
  TARGET_RULE_TYPE_SPECIFIC_CHARACTER = 1; // 特定角色
  TARGET_RULE_TYPE_ANY_CHARACTER_AT_LOCATION = 2; // 在某个地点的任何角色
}
