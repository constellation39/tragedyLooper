syntax = "proto3";

package tragedylooper.v1;

import "tragedylooper/v1/condition.proto";
import "tragedylooper/v1/effect.proto";
import "tragedylooper/v1/enums.proto";
import "tragedylooper/v1/incident.proto";
import "tragedylooper/v1/character.proto";
import "tragedylooper/v1/card.proto";
import "tragedylooper/v1/ability.proto";

option go_package = "github.com/constellation39/tragedyLooper/pkg/proto/v1";

// Script defines the configuration for a tragedy looper script.
message Script {
  // The unique identifier for the script.
  int32 id = 1;
  // The name of the script.
  string name = 2;
  // A description of the script.
  string description = 3;

  // Main plot configurations.
  map<int32, PlotConfig> main_plots = 4;
  // Sub plot configurations.
  map<int32, PlotConfig> sub_plots = 5;

  // Role configurations.
  map<int32, RoleConfig> roles = 6;

  // Incident configurations.
  map<int32, IncidentConfig> incidents = 7;

  // Character configurations.
  map<int32, CharacterConfig> characters = 8;

  // Mastermind card configurations.
  map<int32, CardConfig> mastermind_cards = 9;
  // Protagonist card configurations.
  map<int32, CardConfig> protagonist_cards = 10;

  // A map of script configurations.
  map<int32, ScriptConfig> scripts = 11;
}

// ScriptConfig defines the configuration for a specific script.
message ScriptConfig {
  // Private information for the script.
  PrivateInfo private_info = 1;
  // Public information for the script.
  PublicInfo public_info = 2;
}

// PrivateInfo defines the private information for a script.
message PrivateInfo {
  // The main plot of the script.
  PlotConfig main_plot = 1;
  // A list of sub plots for the script.
  repeated PlotConfig sub_plots = 2;
  // A map of characters in the script.
  map<int32, CharacterConfig> characters = 3;
  // A map of incidents in the script.
  map<int32, IncidentConfig> incidents = 4;
}

// PublicInfo defines the public information for a script.
message PublicInfo {
  // The unique identifier for the script configuration.
  int32 script_config_id = 1;

  // Game rules.
  // The number of loops in the game.
  int32 loop_count = 2;
  // The number of days per loop.
  int32 days_per_loop = 3;
  // Whether players can discuss information.
  bool can_discuss = 4;

  // Special rules.
  // A map of special incidents.
  map<int32, IncidentConfig> special_incidents = 5;
  // A map of scheduled incidents.
  map<int32, IncidentConfig> scheduled_incidents = 6;
}

// RoleConfig defines the configuration for a role.
message RoleConfig {
  // The unique identifier for the role.
  int32 id = 1;
  // The name of the role.
  string name = 2;
  // The limit of characters that can have this role.
  int32 limit = 3;
  // A map of abilities for this role.
  map<int32, AbilityConfig> abilities = 4;
  // Defines the character's goodwill status.
  // 0: normal, 1: ignore goodwill, 2: always ignore goodwill.
  int32 goodwill_rule = 5;
  // Defines if the character can be made invincible.
  bool can_be_invincible = 6;
}

// PlotConfig defines a story plot.
message PlotConfig {
  // The unique identifier for the plot.
  int32 id = 1;
  // The type of the plot.
  PlotType type = 2;
  // The name of the plot.
  string name = 3;
  // A description of the plot.
  string description = 4;
  // A map of incident identifiers for this plot.
  map<int32, IncidentConfig> incident_ids = 5;
  // A map of role assignments for this plot.
  map<int32, int32> role_assignments = 6;
}

// ScriptConfigLib is a library of script configurations.
message ScriptConfigLib {
  // A map of script configurations.
  map<int32, ScriptConfig> scripts = 1;
}
