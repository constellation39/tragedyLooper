syntax = "proto3";

package game;

import "proto/game/effect.proto";
import "proto/game/enums.proto";
import "proto/game/location.proto";

option go_package = "github.com/user/repo/proto/game";

// AbilityTriggerType 定义能力何时可以被触发。
enum AbilityTriggerType {
  ABILITY_TRIGGER_TYPE_UNSPECIFIED = 0;
  ABILITY_TRIGGER_TYPE_DAY_START = 1; // 天开始时
  ABILITY_TRIGGER_TYPE_MASTERMIND_PHASE = 2; // 主谋阶段
  ABILITY_TRIGGER_TYPE_GOODWILL_PHASE = 3; // 好感阶段
  ABILITY_TRIGGER_TYPE_PASSIVE = 4; // 被动
}

// Ability 定义角色的特殊技能。
message Ability {
  string id = 1;
  string name = 2; // 能力名称
  string description = 3; // 能力描述
  AbilityTriggerType trigger_type = 4; // 触发时机
  Effect effect = 5; // 实际效果
  bool once_per_loop = 6; // 每循环只能使用一次
  PlayerRole refusal_role = 7; // 如果有，指定拒绝此善意能力的特定角色身份
  bool used_this_loop = 8; // 运行时状态，不用于配置
  LocationType target_location = 9;
}